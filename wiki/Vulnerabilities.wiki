This is a list of Kaillera vulnerabilities

= Open Kaillera Vulnerabilities =


1.  The following functions use insecure string copying resulting in buffer overflows:

kaillera_gdebug

kaillera_core_debug

kaillera_ui_motd

kaillera_error_callback

kaillera_ui_debug

kaillera_outpf


These functions can all be found in kaillera_ui.cpp. 

= Ownaclient Vulnerabilites =


1.  Function re_append in uihlp.h of Ownaclient introduces a buffer overflow vulnerability relating to handling long strings spammed repeatedly in the server.

2.  Ownaclient inherits Issue #1 from Open Kaillera (because its a modification of that client).  In v18 kaillera_ui_motd is patched, however all other similar functions are left vulnerable.

3.  Two off-by-one overflows exist in Ownaclient v17 relating to username and quit message (not serious because they are local).  Patched in v18.

4.  Crash involved locally in sending long private message.  Patched in v18.

=Kaillera.com/Anti3d Client=

1.  There is a buffer overflow in handling of long usernames which can be triggered via various methods in the Kaillera protocol.  

2.  Denial of service if null byte is used in a username (tested with chat).

3.  Local Denial of Service (paste long string into Custom IP input box)

=Supraclient=

1.  Local buffer overflow in IP and Quit Message input boxes.

2. Multiple buffer overflows in handling of overlong messages coming from Server (MOTD, Quit message, and many others)

3.  DoS with long username in Server Status packet.

4.  Extremely long emulator name causes access violation when hosting game.

=Kaillera 0.86 Server Vulnerabilities =

1.  Denial of Service Attack if malformed packet sent after "hello" packet.  

2.  Buffer overflow found by Luigi Auriemma: http://aluigi.org/adv/kailleraex-adv.txt

=Exploits=

This script here on Exploit-db demonstrates several buffer overflow vulnerabilities in Open Kaillera, the original Kaillera client, and Supraclient: http://www.exploit-db.com/exploits/17460/

This Metasploit module will exploit the 0.86 server DoS vulnerability:

http://metasploit.com/svn/framework3/trunk/modules/auxiliary/dos/windows/games/kaillera.rb

= Caveats =

In terms of real-world exploitability, most of these issues require a rogue / malicious Kaillera server.  

However, there are several issues which can be triggered client-side (even with servers like Emulinker and EMX which are supposed to protect against "hackers").  

== Patches ==

This Google Code website offers patches for Ownaclient v18 (latest) and Open Kaillera (latest compiled version).  

0.86 Server Issue #2 patched at: http://aluigi.org/patches/kailleraexfix.lpatch

=Todo=

Patch Issue #1 in Ownaclient (recently discovered through more testing)